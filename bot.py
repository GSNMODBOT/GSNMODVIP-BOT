import telebot
from config import TOKEN, ADMIN_ID, CHANNEL_USERNAME, CHANNEL_LINK
import random
import time
from datetime import datetime

# ========== ุชููุฆุฉ ุงูุจูุช ==========
bot = telebot.TeleBot(TOKEN)
bot.skip_pending = True  # ุนุดุงู ูุชุฌุงูุฒ ุงููุดุงูู

print("โ ุงูุจูุช ุจุฏุฃ ุงูุชุดุบูู...")
print(f"๐ค ุงุณู ุงูุจูุช: @{bot.get_me().username}")
print("-" * 40)

# ========== ูุงููุณ ูุณุฎ ุจุจุฌู (ุณูู ุงูุชุนุฏูู ูุงูุฅุถุงูุฉ) ==========
ุงููุณุฎ = {
    "v1": {
        "ุงูุงุณู": "๐ฅ ุจุจุฌู ูุงูุช v1 โข ุงุณุชูุฑุงุฑ ุชุงู",
        "ุงูุญุฌู": "680 MB",
        "ุงููุตู": "โข Anti-Ban 100%\nโข 60 FPS ุจุฏูู ุชูุทูุน",
        "ุงูุฑุงุจุท": "https://t.me/kenan_mod_2/37",
        "ุงูุตูุฑุฉ": "https://t.me/kenan_mod_2/36",
    },
    "v2": {
        "ุงูุงุณู": "โก ุจุจุฌู ูุงูุช v2 โข ุณุฑุนุฉ ุงูุฃุณุงุทูุฑ",
        "ุงูุญุฌู": "690 MB",
        "ุงููุตู": "โข ุณุฑุนุฉ ุชุตููุจ ุฎุงุฑูุฉ\nโข Aimbot ุชููุงุฆู",
        "ุงูุฑุงุจุท": "https://t.me/kenan_mod_2/44",
        "ุงูุตูุฑุฉ": "https://t.me/kenan_mod_2/39",
    },
    "v3": {
        "ุงูุงุณู": "๐ฏ ุจุจุฌู ูุงูุช v3 โข ููุฌูุงูุงุช ุงูุถุนููุฉ",
        "ุงูุญุฌู": "675 MB",
        "ุงููุตู": "โข ุชุดุบูู ุนูู 2 ุฌูุฌุง ุฑุงู\nโข ุจุฏูู OBB",
        "ุงูุฑุงุจุท": "https://t.me/kenan_mod_2/47",
        "ุงูุตูุฑุฉ": "https://t.me/kenan_mod_2/45",
    }
}

# ========== ุงูุชุญูู ูู ุงูุงุดุชุฑุงู ูู ุงูููุงุฉ ==========
def ูุดุชุฑู(user_id):
    try:
        ุนุถููุฉ = bot.get_chat_member(CHANNEL_USERNAME, user_id)
        return ุนุถููุฉ.status in ['member', 'administrator', 'creator']
    except:
        return False

# ========== ุฑุณุงูุฉ ุงูุชุฑุญูุจ ุงูุฑุฆูุณูุฉ ==========
@bot.message_handler(commands=['start'])
def start(message):
    user_id = message.from_user.id
    user_name = message.from_user.first_name
    
    # ุญุงูุฉ ุฎุงุตุฉ: ุฅุฐุง ุฏุฎู ุจุฑุงุจุท ูุณุฎุฉ (ุฒู start=v1)
    if len(message.text.split()) > 1:
        ููุฏ_ุงููุณุฎุฉ = message.text.split()[1]
        
        if ููุฏ_ุงููุณุฎุฉ in ุงููุณุฎ:
            ูุณุฎุฉ = ุงููุณุฎ[ููุฏ_ุงููุณุฎุฉ]
            
            # ุฅุฐุง ูุดุชุฑู -> ูุงุฎุฐ ุฑุงุจุท ุงูุชุญููู
            if ูุดุชุฑู(user_id):
                bot.send_message(
                    user_id,
                    f"๐ฎ {ูุณุฎุฉ['ุงูุงุณู']}\n"
                    f"โโโโโโโโโโโโโโ\n"
                    f"๐ฆ {ูุณุฎุฉ['ุงูุญุฌู']}\n"
                    f"{ูุณุฎุฉ['ุงููุตู']}\n"
                    f"โโโโโโโโโโโโโโ\n"
                    f"โฌ๏ธ ุฑุงุจุท ุงูุชุญููู:\n{ูุณุฎุฉ['ุงูุฑุงุจุท']}",
                    disable_web_page_preview=False
                )
            else:
                # ุฅุฐุง ุบูุฑ ูุดุชุฑู -> ูุทูุจ ุงูุงุดุชุฑุงู
                ุฒุฑ = telebot.types.InlineKeyboardMarkup()
                ุฒุฑ.add(telebot.types.InlineKeyboardButton("๐ข ุงุดุชุฑู ุงูุขู", url=CHANNEL_LINK))
                bot.send_photo(
                    user_id,
                    photo=ูุณุฎุฉ['ุงูุตูุฑุฉ'],
                    caption=f"๐ฎ {ูุณุฎุฉ['ุงูุงุณู']}\nโโโโโโโโโโโโโโ\n๐ฆ {ูุณุฎุฉ['ุงูุญุฌู']}\n\nโ๏ธ ูุฌุจ ุงูุงุดุชุฑุงู ูู ุงูููุงุฉ ุฃููุงู ููุชุญููู.",
                    reply_markup=ุฒุฑ
                )
        else:
            bot.reply_to(message, "โ ูุฐุง ุงูุฑุงุจุท ุบูุฑ ุตุญูุญ.")
    else:
        # ุฏุฎูู ุนุงุฏู ุจุฏูู ููุฏ
        bot.reply_to(
            message,
            f"๐น ุฃููุงู {user_name} ูู ุจูุช ุบุณุงู ููุฏ ๐ค\n\n"
            f"ุฃุฑุณู /versions ููุดุงูุฏุฉ ุฌููุน ุงููุณุฎ.\n"
            f"ุฃู ุงุฎุชุฑ ูุณุฎุฉ ูุจุงุดุฑุฉ: /v1 , /v2 , /v3"
        )

# ========== ุนุฑุถ ูู ุงููุณุฎ ==========
@bot.message_handler(commands=['versions', 'ูุณุฎ'])
def ุนุฑุถ_ุงููุณุฎ(message):
    ูุต = "๐ **ุฌููุน ุงููุณุฎ ุงููุชููุฑุฉ:**\n\n"
    for ููุชุงุญ, ุจูุงูุงุช in ุงููุณุฎ.items():
        ูุต += f"๐น {ุจูุงูุงุช['ุงูุงุณู']}\n๐ฆ {ุจูุงูุงุช['ุงูุญุฌู']}\nโฌ๏ธ /{ููุชุงุญ}\n\n"
    bot.reply_to(message, ูุต, parse_mode="Markdown")

# ========== ุฃูุงูุฑ ุงููุณุฎ ุงููุฑุฏูุฉ (/v1, /v2, /v3) ==========
@bot.message_handler(commands=['v1', 'v2', 'v3'])
def ูุณุฎุฉ_ูุญุฏุฏุฉ(message):
    user_id = message.from_user.id
    ููุฏ_ุงููุณุฎุฉ = message.text[1:]  # v1, v2, v3
    
    if ููุฏ_ุงููุณุฎุฉ in ุงููุณุฎ:
        ุจูุงูุงุช = ุงููุณุฎ[ููุฏ_ุงููุณุฎุฉ]
        
        if ูุดุชุฑู(user_id):
            bot.reply_to(
                message,
                f"{ุจูุงูุงุช['ุงูุงุณู']}\n๐ฆ {ุจูุงูุงุช['ุงูุญุฌู']}\n{ุจูุงูุงุช['ุงููุตู']}\n\nโฌ๏ธ {ุจูุงูุงุช['ุงูุฑุงุจุท']}"
            )
        else:
            ุฒุฑ = telebot.types.InlineKeyboardMarkup()
            ุฒุฑ.add(telebot.types.InlineKeyboardButton("๐ข ุงุดุชุฑู ุงูุขู", url=CHANNEL_LINK))
            bot.reply_to(
                message,
                f"โ๏ธ ูุฌุจ ุงูุงุดุชุฑุงู ูู ุงูููุงุฉ ุฃููุงู:\n{CHANNEL_LINK}",
                reply_markup=ุฒุฑ
            )
    else:
        bot.reply_to(message, "โ ูุฐู ุงููุณุฎุฉ ุบูุฑ ููุฌูุฏุฉ.")

# ========== ุงูุฑุฏูุฏ ุงูุชููุงุฆูุฉ ุงูุฐููุฉ (ุญู ุฌููุน ุงููุดุงูู ุงูุณุงุจูุฉ) ==========
@bot.message_handler(func=lambda message: True)
def ุฑุฏูุฏ_ุชููุงุฆูุฉ(message):
    ูุต = message.text.strip()
    ุฑุฏ = None
    
    # ุชุญูุงุช
    if "ุงูุณูุงู" in ูุต or "ุณูุงู" in ูุต:
        ุฑุฏ = "๐น ูุนูููู ุงูุณูุงู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชู"
    elif "ุดูุฑุง" in ูุต or "ุดูุฑูุง" in ูุต:
        ุฑุฏ = "๐ค ุงูุนููุ ูุฐุง ูุงุฌุจูุง"
    elif "ูููู" in ูุต:
        ุฑุฏ = "ุงูุญูุฏูููุ ุงูุช ููููุ"
    elif "ูู ููู" in ูุต:
        ุฑุฏ = "ุฃูุง ุจูุชุ ุณุงูู ูู ุงูุณุญุงุจุฉ โ๏ธ"
    
    # ุงุณุชูุณุงุฑุงุช ุชูููุฉ
    elif "ุญู ูุดููู" in ูุต or "ูุดููุฉ" in ูุต:
        ุฑุฏ = "๐๏ธ ุงุดุฑุญูู ุงููุดููุฉ ุจุงูุชูุตููุ ูุฃูุง ุฃุญุงูู ุฃุณุงุนุฏู"
    elif "ูุตุฉ" in ูุต:
        ุฑุฏ = "๐ ูุงู ูุง ูุง ูุงูุ ูู ูุฏูู ุงูุฒูุงูุ ุจูุช ุงุณูู ุบุณุงู ููุฏ... (ูุณู ุงููุตุฉ ููุฏ ุงููุชุงุจุฉ ๐)"
    elif "ุงููุจูุช" in ูุต:
        ุฑุฏ = "๐ซ ุงูุฅููุจูุช ููุฌูุฏ ูู ูุณุฎุฉ v2 ุฌุฑุจูุง:\nhttps://t.me/kenan_mod_2/44"
    elif "ุณููุงุช" in ูุต or "ุงุณููุงุช" in ูุต:
        ุฑุฏ = "๐ญ ูุฑูุจูุง ูู ูุณุฎุฉ v4 ุณููุงุช ุญุตุฑูุฉุ ุชุงุจุน ุงูููุงุฉ."
    
    # ุฃู ููุงู ุขุฎุฑ
    if ุฑุฏ:
        bot.reply_to(message, ุฑุฏ)
    else:
        # ุงุฎุชูุงุฑู: ุฑุฏูุฏ ุนุดูุงุฆูุฉ ูุทููุฉ
        ุฑุฏูุฏ_ุนุดูุงุฆูุฉ = [
            "๐ ุฃููุงูุ ููู ุฃูุฏุฑ ุฃุณุงุนุฏูุ",
            "๐ ุชุญุช ุฃูุฑู",
            "๐น ุชูุถู"
        ]
        bot.reply_to(message, random.choice(ุฑุฏูุฏ_ุนุดูุงุฆูุฉ))

# ========== ุชุดุบูู ุงูุจูุช (ุจุงูู ุดุบุงู ูู ุญุตู ุฎุทุฃ) ==========
if __name__ == "__main__":
    print("โ ุงูุจูุช ูุนูู ุงูุขู...")
    while True:
        try:
            bot.polling(none_stop=True)
        except Exception as e:
            print(f"โ๏ธ ุฎุทุฃ: {e}ุ ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุจุนุฏ 3 ุซูุงูู...")
            time.sleep(3)
